function checkCount(){if(void 0===$.cookie("gatyacount"))return 1;{const t=new Date,e=new Date($.cookie("gatyacount"));if(t.getHours()===e.getHours()){const o=Math.abs(e-t)/6e4,a=Math.floor(o)/5;return Math.floor(a)}return 1}}window.toggleBtn=!0,$(document).ready(function(){$("#doLogin").on("click",function(){const t=$("#user_name").val(),e=$("#password").val();if(!t||!e)return $("#error").text("入力されていない項目があります。");fetch("/login",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({user_name:t,password:e})}).then(t=>t.json()).then(t=>{if("error"===t.status)return $("#error").text(t.message);location.href="/"})}),$("#doRegist").on("click",function(){const t=$("#user_name").val(),e=$("#password").val();if(!t||!e)return $("#error").text("入力されていない項目があります。");fetch("/regist",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({user_name:t,password:e})}).then(t=>t.json()).then(t=>{if("error"===t.status)return $("#error").text(t.message);location.href="/"})}),$("#doLoadCard").on("click",function(){if(window.toggleBtn){if(window.toggleBtn=!1,$("#gacha_card").fadeOut("slow"),0===checkCount())return alert("まだ引けません！"),void(window.toggleBtn=!0);$(".gacha_img_container").addClass("shake_box"),fetch("/loadcard",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}}).then(t=>t.json()).then(t=>{if("error"!==t.status)if(setTimeout(function(){$(".card_img").children("img").attr("src",`images/card/${t.resData.card_img}`),$("#cardName").text(t.resData.card_name),$("#gacha_card").fadeIn("slow"),$(".gacha_img_container").removeClass("shake_box"),window.toggleBtn=!0},2e3),void 0===$.cookie("gatyacount"))$.cookie("gatyacount",(new Date).toString(),{expires:1}),$("#gacha_count").text(`あと ${checkCount()} 回`);else{let t=new Date($.cookie("gatyacount"));t=t.setMinutes(t.getMinutes()+5),$.cookie("gatyacount",new Date(t).toString(),{expires:1}),$("#gacha_count").text(`あと ${checkCount()} 回`)}else alert(t.message)})}}),$("#gacha_count")[0]&&$("#gacha_count").text(`あと ${checkCount()} 回`)});